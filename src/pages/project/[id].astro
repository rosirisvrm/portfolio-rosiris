---
import Layout from '../../layouts/Layout.astro';
import ActionButton from '../../components/ActionButton.astro';
import GithubIcon from '../../components/icons/GithubIcon.astro';
import TechSkillItem from '../../components/TechSkillItem.astro';
import BackIcon from '../../components/icons/BackIcon.astro';
import LinkIcon from '../../components/icons/LinkIcon.astro';
// import ItemIcon from '../../components/icons/ItemIcon.astro';
import { projects, technologies as allTecnologies } from '../../data';

export const prerender = false;

const { id } = Astro.params;

const project = projects.find((p) => p.id === id)

if(!project) return Astro.redirect("/");

const { title, description, imgUrl, repoUrl, demoUrl, technologies: projectTechnologies } = project;

---

<Layout>	
	<main class="w-full min-h-screen section-bg pb-10">	

        <div class="pt-6 pb-3 px-6 sm:px-12 lg:px-20">
            <a href="/#projects" class="text-white cursor-pointer">
                <BackIcon class='size-5 sm:size-8 transition hover:scale-110' />
            </a>
        </div>


        <div class="
            max-w-2xl mx-6 sm:mx-auto 
            flex flex-col gap-6 project-card-bg p-6 rounded-2xl
        ">
            <img src={`../../public/${imgUrl}.png`} class="w-full h-52 sm:h-72 rounded-xl" />
            <h5 class="uppercase font-bold sm:text-lg text-base">{title || ''}</h5>
            <p class="sm:text-sm text-xs mb-5">
                {description || ''}
            </p>
            <div class="flex flex-row gap-2 flex-wrap justify-center">
                {projectTechnologies.map((tech) => {
                    let renderTechnology: any = null;

                    allTecnologies.forEach((item) => {
                        if(item.id === tech){
                            const Icon = item.icon
                            renderTechnology = (
                                <TechSkillItem>
                                    <Icon class='sm:size-4 size-3' />
                                    {item.name}
                                </TechSkillItem>
                            )
                        }
                        // else{
                        //     renderTechnology = (
                        //         <TechSkillItem>
                        //             <ItemIcon class='sm:size-4 size-3' />
                        //             {tech}
                        //         </TechSkillItem>
                        //     )
                        // }
                    })

                    return renderTechnology;
                })}
            </div>
            <div class="flex flex-row gap-4 justify-center items-center flex-wrap">
                <div class="flex flex-column w-full sm:w-1/3 sm:justify-end">
                    <ActionButton href={repoUrl} target='_blank' class='w-full sm:w-48'>
                        <GithubIcon class="sm:size-4 size-3" />
                        Ver repositorio
                    </ActionButton>
                </div>
                <div class="flex flex-column w-full sm:w-1/3">
                    <ActionButton href={demoUrl} target='_blank' class='w-full sm:w-48'>
                        <LinkIcon class="sm:size-4 size-3" />
                        Ver demo
                    </ActionButton>
                </div>
            </div>
        </div>

	</main>
</Layout>
